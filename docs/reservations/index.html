<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Reservations | Lukasz’s GoKarts</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="Reservations" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The best rides in Colorado" />
<meta property="og:description" content="The best rides in Colorado" />
<link rel="canonical" href="http://localhost:4000/web2-lptak/reservations/" />
<meta property="og:url" content="http://localhost:4000/web2-lptak/reservations/" />
<meta property="og:site_name" content="Lukasz’s GoKarts" />
<script type="application/ld+json">
{"@type":"WebPage","url":"http://localhost:4000/web2-lptak/reservations/","headline":"Reservations","description":"The best rides in Colorado","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/web2-lptak/assets/main.css">
  <link rel="stylesheet" href="/web2-lptak/assets/css/bootstrap_fix.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <!-- <script src="https://code.jquery.com/jquery-3.5.0.min.js" integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ=" crossorigin="anonymous"></script> -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <script src ="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.1/jquery.validate.min.js" integrity="sha512-0QDLUJ0ILnknsQdYYjG7v2j8wERkKufvjBNmng/EdR/s/SE7X8cQ9y0+wMzuQT0lfXQ/NhG+zhmHNOWTUS3kMA==" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/additional-methods.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/js-cookie@2.2.1/src/js.cookie.min.js" integrity="sha512-ucXfgzwosc1HJKUxNHJIuwKhy82wQRm/ROiJpsyp8RwzVgkYD0yQQX9dlZlM9iUF8u3HZdb54mUmwsHuNutOpA==" crossorigin="anonymous"></script><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/web2-lptak/feed.xml" title="Lukasz's GoKarts" /></head>
<body><header class="site-header" role="banner">

  <nav class="navbar navbar-expand-lg navbar-light bg-light" style="max-width: calc(800px - (30px * 2)); margin-left: auto; margin-right: auto;">
  <!-- <div class="wrapper bg-light"> --><a class="navbar-brand" rel="author" href="/web2-lptak/">Lukasz&#39;s GoKarts</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button><div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
        <!-- <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label> --><li class="nav-item">
                  <a class="nav-link" href="/web2-lptak/about/">About</a>
                </li><li class="nav-item">
                  <a class="nav-link" href="/web2-lptak/reservations/">Reservations</a>
                </li><li class="nav-item">
                  <a class="nav-link" href="/web2-lptak/signin/">Sign in</a>
                </li><li class="nav-item">
                  <a class="nav-link" href="/web2-lptak/sign_up/">Sign up</a>
                </li></ul>
      </div><!-- </div> -->
  </nav>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <!-- <header class="post-header">
    <h1 class="post-title">Reservations</h1>
  </header> -->

  <div class="post-content">
    <div class="container bg-light">
    <h2>Reservations</h2>
    <div class="row mt-3">
        <div id="new_reservations" class="col-sm-4">
            <p>Select date</p>
            <div class="form-group">
                <div class="input-group date" id="datetimepicker">
                    <input id="date_choice" type="date" class="form-control datepicker" onchange="date_changed(event);" />
                </div>
                <div class="input-group" id="signed_in">
                    <p>Select the time of your reservation</p>
                    <input id="time_choice" type="time" class="form-control" min="10:00" max="21:30" step="30m" />
                    <button class="btn btn-primary btn-block" onclick="reserve();">Make Reservation</button>
                </div>
                <div class="input-group" id="signed_out">
                    <p>Please sign in to view reservation form</p>
                </div>
            </div>
            <!-- <div id="signed_in" hidden>
            </div> -->
            <!-- <div id="signed_out" hidden>
                <p>You need to sign in first to make a new reservation!</p>
            </div> -->
        </div>
        <div class="col-sm">
            <p>Reservations for <a id="display_date">today</a></p>
            <table class="table">
                <thead>
                    <th scope="col">Time</th>
                    <th scope="col">Reserved by</th>
                </thead>
                <tbody id="times_body">
                <!-- Entries will be populated with JS -->
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>

var hour_start = 10;
var minute_start = 0;

var hour_end = 21;
var minute_end = 30;

var step = 30; // minutes

var date;

$(function(){
    if (Cookies.get("auth") === "1") {
        show_signed_in();
    } else {
        show_signed_out();
    }
});

$(function() {
    let e = {};
    e.target = {};
    e.target.value = "2020-04-09";
    refresh_event_list("2020-04-09");
});

function get_reservations(date) {
    let obj = Cookies.get(date);
    if (obj === undefined) {
        obj= "{}";
    }
    return JSON.parse(obj);
}

function get_user() {
    let obj = Cookies.get("user");
    if (obj === undefined) {
        obj= "{}";
    }
    return JSON.parse(obj);
}

function show_signed_in() {
    $("#signed_in").removeAttr("hidden");
    $("#signed_out").attr("hidden", "");
}

function show_signed_out() {
    $("#signed_out").removeAttr("hidden");
    $("#signed_in").attr("hidden", "");
}

function reserve() {
    let usr = get_user();
    let name = usr["full_name"];
    let selected_time = $("#time_choice").val();
    if(!selected_time || !$("#date_choice").val()) {
        alert("Please select the time of your reservation", selected_time);
        return;
    }
    let res = get_reservations(date.toString());
    res[selected_time] = name;
    Cookies.set(date.toString(), res);
    refresh_event_list(date);
}

function format_date(hour, minute) {
    ret = "";
    if (hour < 10)
        ret += "0";
    ret += hour.toString();
    ret += ":";
    if (minute < 10)
        ret += "0";
    ret += minute.toString();
    return ret;
}

function refresh_event_list(date) {
    // $("#display_date").text(new_date);

    $("#times_body").empty();
    let reservations = get_reservations(date);
    for (i = hour_start*60+minute_start; i <= hour_end*60+minute_end; i+= step) {
        let row = $("<tr/>");
        let time = $('<th scope="row" class="col-sm-3"/>');
        let reserved_by = $('<td/>');

        let hh = Math.floor(i/60).toString();
        let mm = (i%60).toString();
        let formatted_time = format_date(hh, mm);
        time.text(formatted_time);

        if (formatted_time in reservations) {
            reserved_by.text(reservations[formatted_time]);
        } else {
            reserved_by.text("Free").addClass("disabled")
        }

        $("#times_body").append(row.append(time).append(reserved_by))
    }
}

function date_changed(event) {
    var new_date = event.target.value;
    $("#display_date").text(new_date);
    date = new_date
    refresh_event_list(new_date);
}
</script>


  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/web2-lptak/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Lukasz&#39;s GoKarts</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Lukasz&#39;s GoKarts</li><li><a class="u-email" href="mailto:noreply@google.com">noreply@google.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/StylishTriangles"><svg class="svg-icon"><use  class="use-fix" xlink:href="/web2-lptak/assets/minima-social-icons.svg#github"></use></svg> <span class="username">StylishTriangles</span></a></li><li><a href="https://www.twitter.com/Ghost5231"><svg class="svg-icon"><use  class="use-fix" xlink:href="/web2-lptak/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">Ghost5231</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>The best rides in Colorado</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
